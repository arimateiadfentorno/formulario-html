<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Formulário</title>
</head>
<body>

<h2>Cadastro</h2>

<form id="formulario">

  <input type="text" id="nome" placeholder="Nome" required><br><br>

  <input type="text" id="campo2" placeholder="Outro campo"><br><br>

  <select id="regiao" onchange="atualizarIgrejas()" required>
    <option value="">Selecione a região</option>
  </select><br><br>

  <select id="igreja" required>
    <option value="">Selecione a igreja</option>
  </select><br><br>

  <input type="number" id="quantidade" placeholder="Quantidade" required><br><br>

  <button type="submit">Enviar</button>

</form>

<script>
const API = "https://script.google.com/macros/s/AKfycbx1flJANfl84_6NvNdfKCH4ScSAuvlRUEJHDe5o5P_A2bgjnB3D96wedkkhYiVxaz5l/exec";

// carrega regiões
window.onload = () => {
  fetch(API + "?tipo=regioes")
    .then(r => r.json())
    .then(lista => {
      const select = document.getElementById("regiao");
      lista.forEach(r => {
        const opt = document.createElement("option");
        opt.value = r.id;
        opt.text = r.nome;
        select.add(opt);
      });
    });
};

// carrega igrejas conforme região
function atualizarIgrejas() {
  const regiaoId = document.getElementById("regiao").value;
  const igreja = document.getElementById("igreja");

  igreja.innerHTML = "<option value=''>Selecione</option>";

  if (!regiaoId) return;

  fetch(API + "?tipo=igrejas&regiao=" + regiaoId)
    .then(r => r.json())
    .then(lista => {
      lista.forEach(i => {
        const opt = document.createElement("option");
        opt.value = i.id;
        opt.text = i.nome;
        igreja.add(opt);
      });
    });
}

// envio do formulário
document.getElementById("formulario").addEventListener("submit", function(e) {
  e.preventDefault();

  fetch(API, {
    method: "POST",
    body: JSON.stringify({
      nome: nome.value,
      campo2: campo2.value,
      regiao: regiao.value,
      igreja: igreja.value,
      quantidade: quantidade.value
    })
  })
  .then(() => alert("Dados enviados com sucesso!"))
  .catch(() => alert("Erro ao enviar"));
});
</script>

</body>
</html>
